webpackJsonp([0],{E2Ap:function(e,t,r){t=e.exports=r("FZ+f")(!1),t.push([e.i,".heng{margin:20px 0;height:1px;border:0;background-color:rgba(174,127,255,.38);color:#29e11c}.addticket{margin:50px;width:80%}.tips{color:hsla(0,0%,50%,.65)}",""])},GGwe:function(e,t,r){"use strict";function a(e){r("gaPO")}Object.defineProperty(t,"__esModule",{value:!0});var o=r("BO1k"),n=r.n(o),i=r("Dd8w"),s=r.n(i),l=r("ZTLr"),u=r("nSkA"),c=r("vMJZ"),d=r("QmSG"),p=r("NYxO"),m=r("V9py"),f=r.n(m),h={components:{},data:function(){return{route_path:this.$route.path.split("/"),ruleForm:{title:"",type:"",content:"",create_user:localStorage.getItem("username"),level:2,action_user:"itsupport",follower:"",create_group:"",ticketid:""},rules:{title:[{required:!0,message:"请输入工单标题",trigger:"blur"}],content:[{required:!0,message:"请输入工单内容",trigger:"blur"}],type:[{required:!0,message:"请选择工单类型",trigger:"blur"}],level:[{required:!0,type:"number",message:"请确认工单等级",trigger:"blur"}]},users:[],fileList:[],count:0,enclosureFile:[],enclosureForm:{ticket:"",create_user:localStorage.getItem("username"),file:"",create_group:""},toolbars:{preview:!0,bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,ol:!0,fullscreen:!0,help:!0},img_file:{},formDataList:[],to_list:"",cc_list:"",uploadurl:d.uploadurl,types:[]}},computed:s()({},Object(p.b)(["username"])),created:function(){this.getTicketUsers(),this.getTicketType()},methods:{postForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.ruleForm.ticketid=f()(),Object(l.k)(t.ruleForm).then(function(e){'"Created"'===e.statusText&&t.$message({type:"success",message:"恭喜你，新建成功"});var r=!0,a=!1,o=void 0;try{for(var i,s=n()(t.fileList);!(r=(i=s.next()).done);r=!0){var c=i.value,d=new FormData;d.append("username",t.enclosureForm.create_user),d.append("file",c),d.append("create_time",f()(c.uid)),d.append("type",c.type),d.append("archive",t.route_path[1]),Object(u.d)(d).then(function(r){t.enclosureForm.file=r.data.filepath,t.enclosureForm.ticket=e.data.id,Object(l.i)(t.enclosureForm)})}}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}var p={to:t.ruleForm.action_user,cc:t.ruleForm.follower.join(),sub:"【新工单】"+t.ruleForm.title,header:window.location.host+"/#/worktickets/editworkticket/"+t.ruleForm.ticketid,content:""};Object(u.c)(p),t.$router.push("/worktickets/workticket")})})},resetForm:function(e){this.$refs[e].resetFields()},getTicketUsers:function(){var e=this;Object(c.f)().then(function(t){e.users=t.data})},getTicketType:function(){var e=this;Object(l.e)().then(function(t){e.types=t.data})},handleSuccess:function(e,t){this.fileList.push(t.raw),this.count+=1},handleRemove:function(e,t){this.fileList.remove(e),this.count-=1},imgAdd:function(e,t){var r=this.$refs.md,a=new FormData;a.append("username",this.enclosureForm.create_user),a.append("file",t),a.append("create_time",f()(t.lastModified)),a.append("type",t.type),a.append("archive",this.route_path[1]),Object(u.d)(a).then(function(t){r.$imglst2Url([[e,t.data.file]])})}}},g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"components-container",staticStyle:{height:"100vh"}},[r("el-card",[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"指派人",prop:"action_user"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择指派人"},model:{value:e.ruleForm.action_user,callback:function(t){e.$set(e.ruleForm,"action_user",t)},expression:"ruleForm.action_user"}},e._l(e.users,function(e){return r("el-option",{key:e.id,attrs:{value:e.username}})})),e._v(" "),r("a",{staticClass:"tips"},[e._v(" Tip：当前工单处理人，默认是指派给ITSupport群组")])],1),e._v(" "),r("el-form-item",{attrs:{label:"跟踪者",prop:"follower"}},[r("el-select",{attrs:{filterable:"",multiple:"",placeholder:"请选择跟踪者"},model:{value:e.ruleForm.follower,callback:function(t){e.$set(e.ruleForm,"follower",t)},expression:"ruleForm.follower"}},e._l(e.users,function(e){return r("el-option",{key:e.id,attrs:{value:e.username}})})),e._v(" "),r("a",{staticClass:"tips"},[e._v(" Tip：工单状态发生变更时，邮件抄送给跟踪者")])],1),e._v(" "),r("el-form-item",{attrs:{label:"工单类型",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择工单类型"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},e._l(e.types,function(e){return r("el-option",{key:e.id,attrs:{value:e.name}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"工单内容",prop:"content"}},[r("mavon-editor",{ref:"md",staticStyle:{"z-index":"1"},attrs:{code_style:"monokai",toolbars:e.toolbars},on:{imgAdd:e.imgAdd},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"工单等级",prop:"level"}},[r("el-rate",{attrs:{colors:["#99A9BF","#F7BA2A","#ff1425"],"show-text":"",texts:["E","D","C","B","A"]},model:{value:e.ruleForm.level,callback:function(t){e.$set(e.ruleForm,"level",t)},expression:"ruleForm.level"}}),e._v(" "),r("div",[r("hr",{staticClass:"heng"}),e._v(" "),r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.uploadurl,"on-success":e.handleSuccess,"on-remove":e.handleRemove,"file-list":e.fileList}},[r("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",disabled:e.count>2},slot:"trigger"},[e._v("\n              上传文件\n            ")]),e._v("\n            (可以不用上传)\n            "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[r("p",[e._v("上传文件不超过10m，"),r("a",{staticStyle:{color:"red"}},[e._v("最多只能上传3个文件")])])])],1),e._v(" "),r("hr",{staticClass:"heng"})],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.postForm("ruleForm")}}},[e._v("提交")]),e._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.resetForm("ruleForm")}}},[e._v("清空")])],1)],1)],1)],1)},b=[],v={render:g,staticRenderFns:b},k=v,x=r("VU/8"),y=a,w=x(h,k,!1,y,null,null);t.default=w.exports},V9py:function(e,t){e.exports=function(e){var t=void 0;return t=e?new Date(e):new Date,t.getFullYear().toString()+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+t.getDate()+t.getHours()+t.getMinutes()+t.getSeconds()}},ZTLr:function(e,t,r){"use strict";function a(e){return Object(h.a)({url:b.a.worktickers,method:"post",data:e})}function o(e){return Object(h.a)({url:b.a.worktickers,method:"get",params:e})}function n(e,t){return Object(h.a)({url:b.a.worktickers+e+"/",method:"patch",data:t})}function i(e){return Object(h.a)({url:b.a.tickettypes,method:"post",data:e})}function s(e){return Object(h.a)({url:b.a.tickettypes,method:"get",params:e})}function l(e,t){return Object(h.a)({url:b.a.tickettypes+e+"/",method:"put",data:t})}function u(e){return Object(h.a)({url:b.a.tickettypes+e+"/",method:"delete"})}function c(e){return Object(h.a)({url:b.a.ticketcomments,method:"post",data:e})}function d(e){return Object(h.a)({url:b.a.ticketcomments,method:"get",params:e})}function p(e){return Object(h.a)({url:b.a.ticketenclosures,method:"post",data:e})}function m(e){return Object(h.a)({url:b.a.ticketenclosures,method:"get",params:e})}function f(e){return Object(h.a)({url:b.a.ticketenclosures+e+"/",method:"delete"})}t.k=a,t.f=o,t.g=n,t.j=i,t.e=s,t.l=l,t.b=u,t.h=c,t.c=d,t.i=p,t.d=m,t.a=f;var h=r("vLgD"),g=r("QmSG"),b=r.n(g)},gaPO:function(e,t,r){var a=r("E2Ap");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r("rjj0")("01d8e1be",a,!0)},kCe2:function(e,t,r){"use strict";function a(e){r("vZ2Z")}var o={name:"PanThumb",props:{image:{type:String,required:!0},zIndex:{type:Number,default:100},width:{type:String,default:"150px"},height:{type:String,default:"150px"}}},n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pan-item",style:{zIndex:e.zIndex,height:e.height,width:e.width}},[r("div",{staticClass:"pan-info"},[r("div",{staticClass:"pan-info-roles-container"},[e._t("default")],2)]),e._v(" "),r("img",{staticClass:"pan-thumb",attrs:{src:e.image}})])},i=[],s={render:n,staticRenderFns:i},l=s,u=r("VU/8"),c=a,d=u(o,l,!1,c,"data-v-d3909884",null);t.a=d.exports},nSkA:function(e,t,r){"use strict";function a(e){return Object(s.a)({url:u.a.uploads,method:"post",data:e})}function o(e,t){return Object(s.a)({url:t?u.a.uploads+t+"/":u.a.uploads,method:"get",params:e})}function n(e){return Object(s.a)({url:u.a.uploads+e+"/",method:"delete"})}function i(e){return Object(s.a)({url:u.a.sendmail,method:"post",data:e})}t.d=a,t.b=o,t.a=n,t.c=i;var s=r("vLgD"),l=r("QmSG"),u=r.n(l)},tmVe:function(e,t,r){t=e.exports=r("FZ+f")(!1),t.push([e.i,'.pan-item[data-v-d3909884]{width:200px;height:200px;border-radius:50%;display:inline-block;position:relative;cursor:default;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.2);box-shadow:0 1px 3px rgba(0,0,0,.2)}.pan-info-roles-container[data-v-d3909884]{padding:20px;text-align:center}.pan-thumb[data-v-d3909884]{width:100%;height:100%;background-size:100%;border-radius:50%;overflow:hidden;position:absolute;-webkit-transform-origin:95% 40%;transform-origin:95% 40%;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}.pan-thumb[data-v-d3909884]:after{content:"";width:8px;height:8px;position:absolute;border-radius:50%;top:40%;left:95%;margin:-4px 0 0 -4px;background:radial-gradient(ellipse at center,#0e0e0e 0,#7d7e7d 100%);-webkit-box-shadow:0 0 1px hsla(0,0%,100%,.9);box-shadow:0 0 1px hsla(0,0%,100%,.9)}.pan-info[data-v-d3909884]{position:absolute;width:inherit;height:inherit;border-radius:50%;overflow:hidden;-webkit-box-shadow:inset 0 0 0 5px rgba(0,0,0,.05);box-shadow:inset 0 0 0 5px rgba(0,0,0,.05)}.pan-info h3[data-v-d3909884]{color:#fff;text-transform:uppercase;position:relative;letter-spacing:2px;font-size:18px;margin:0 60px;padding:22px 0 0;height:85px;font-family:Open Sans,Arial,sans-serif;text-shadow:0 0 1px #fff,0 1px 2px rgba(0,0,0,.3)}.pan-info p[data-v-d3909884]{color:#fff;padding:10px 5px;font-style:italic;margin:0 30px;font-size:12px;border-top:1px solid hsla(0,0%,100%,.5)}.pan-info p a[data-v-d3909884]{display:block;color:#333;width:80px;height:80px;background:hsla(0,0%,100%,.3);border-radius:50%;color:#fff;font-style:normal;font-weight:700;text-transform:uppercase;font-size:9px;letter-spacing:1px;padding-top:24px;margin:7px auto 0;font-family:Open Sans,Arial,sans-serif;opacity:0;-webkit-transition:opacity .3s ease-in-out .2s,background .2s linear 0s,-webkit-transform .3s ease-in-out .2s;transition:opacity .3s ease-in-out .2s,background .2s linear 0s,-webkit-transform .3s ease-in-out .2s;transition:transform .3s ease-in-out .2s,opacity .3s ease-in-out .2s,background .2s linear 0s;transition:transform .3s ease-in-out .2s,opacity .3s ease-in-out .2s,background .2s linear 0s,-webkit-transform .3s ease-in-out .2s;-webkit-transform:translateX(60px) rotate(90deg);transform:translateX(60px) rotate(90deg)}.pan-info p a[data-v-d3909884]:hover{background:hsla(0,0%,100%,.5)}.pan-item:hover .pan-thumb[data-v-d3909884]{-webkit-transform:rotate(-110deg);transform:rotate(-110deg)}.pan-item:hover .pan-info p a[data-v-d3909884]{opacity:1;-webkit-transform:translateX(0) rotate(0deg);transform:translateX(0) rotate(0deg)}',""])},vMJZ:function(e,t,r){"use strict";function a(e){return Object(m.a)({url:h.a.users,method:"post",data:e})}function o(e){return Object(m.a)({url:h.a.users,method:"get",params:e})}function n(e,t){return Object(m.a)({url:h.a.users+e+"/",method:"patch",data:t})}function i(e){return Object(m.a)({url:h.a.users+e,method:"delete"})}function s(e){return Object(m.a)({url:h.a.groups,method:"post",data:e})}function l(e){return Object(m.a)({url:h.a.groups,method:"get",params:e})}function u(e){return Object(m.a)({url:h.a.groups+e,method:"delete"})}function c(e){return Object(m.a)({url:h.a.roles,method:"post",data:e})}function d(e){return Object(m.a)({url:h.a.roles,method:"get",params:e})}function p(e){return Object(m.a)({url:h.a.roles+e,method:"delete"})}t.j=a,t.f=o,t.g=n,t.c=i,t.h=s,t.d=l,t.a=u,t.i=c,t.e=d,t.b=p;var m=r("vLgD"),f=r("QmSG"),h=r.n(f)},vZ2Z:function(e,t,r){var a=r("tmVe");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r("rjj0")("4728ef61",a,!0)}});