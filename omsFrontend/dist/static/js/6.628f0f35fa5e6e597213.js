webpackJsonp([6,30,31],{CCE7:function(t,e,a){"use strict";function r(t){a("pWMD")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("YNWT"),n={props:["selectdata"],data:function(){return{value:[],alldata:[],changedata:!1}},created:function(){this.getData()},methods:{getData:function(){var t=this;this.alldata=[],this.value=this.selectdata,Object(s.b)().then(function(e){t.alldata=[];for(var a=e.data,r=0,s=a.length;r<s;r++)t.alldata.push({label:a[r].name,key:a[r].groupid})})},handleChange:function(t,e,a){this.$emit("getDatas",t)}},watch:{selectdata:function(){this.getData()}}},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("el-transfer",{attrs:{filterable:"",titles:["未选择","已选择"],"button-texts":["向左走","向右走"],data:t.alldata},on:{change:t.handleChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)])},l=[],i={render:o,staticRenderFns:l},c=i,u=a("VU/8"),d=r,f=u(n,c,!1,d,null,null);e.default=f.exports},F1wk:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".transfer-footer{margin-left:20px;padding:6px 5px}",""])},"H+He":function(t,e,a){"use strict";function r(t){a("hBdI")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("YNWT"),n={props:["selectdata"],data:function(){return{alldata:[],value:[],changedata:!1}},created:function(){this.getData()},methods:{getData:function(){var t=this;this.alldata=[],this.value=this.selectdata,Object(s.c)().then(function(e){t.alldata=[];for(var a=e.data,r=0,s=a.length;r<s;r++)t.alldata.push({label:a[r].host,key:a[r].templateid})})},handleChange:function(t,e,a){this.$emit("getDatas",t)}},watch:{selectdata:function(){this.getData()}}},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("el-transfer",{attrs:{filterable:"",titles:["未选择","已选择"],"button-texts":["向左走","向右走"],data:t.alldata},on:{change:t.handleChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)])},l=[],i={render:o,staticRenderFns:l},c=i,u=a("VU/8"),d=r,f=u(n,c,!1,d,null,null);e.default=f.exports},NZ1f:function(t,e,a){"use strict";function r(t){a("zgBx")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),n=a.n(s),o=a("BO1k"),l=a.n(o),i=a("YNWT"),c=a("QmSG"),u=a("CCE7"),d=a("H+He"),f={components:{sesectGroups:u.default,sesectTemps:d.default},data:function(){return{tableData:[],tabletotal:0,currentPage:1,pagesize:c.pagesize,pageformat:c.pageformat,listQuery:{limit:c.LIMIT,offset:0,search:""},STATUS_COLOR:{0:"success",1:"danger"},STATUS_TEXT:{0:"enabled",1:"disabled"},dataloading:!0,addForm:!1,ruleForm:{hostnames:[],hostgroups:[],templates:[]},hostnames:"",editForm:!1,rowdata:{}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;Object(i.a)(this.listQuery).then(function(e){t.tableData=e.data.results,t.tabletotal=e.data.count,t.dataloading=!1})},searchClick:function(){this.fetchData()},handleSizeChange:function(t){this.listQuery.limit=t,this.fetchData()},handleCurrentChange:function(t){this.listQuery.offset=t-1,this.fetchData()},getGroups:function(t){this.ruleForm.hostgroups=t,this.rowdata.hostgroups=t},getTemps:function(t){this.ruleForm.templates=t,this.rowdata.templates=t},createGroup:function(){var t=this;this.ruleForm.action="create",this.ruleForm.hostnames=this.hostnames.split("|"),Object(i.d)(this.ruleForm).then(function(e){var a=11,r=!0,s=!1,n=void 0;try{for(var o,i=l()(e.data);!(r=(o=i.next()).done);r=!0){var c=o.value;a*=3,t.$notify({title:c.title,message:c.message,type:c.type,offset:a})}}catch(t){s=!0,n=t}finally{try{!r&&i.return&&i.return()}finally{if(s)throw n}}t.fetchData(),t.addForm=!1}).catch(function(e){var a=n()(e.response.data);t.$message.error(a)})},changeGroup:function(t){this.rowdata.hostid=t.hostid,this.rowdata.host=t.host,this.rowdata.hostgroups=[];var e=!0,a=!1,r=void 0;try{for(var s,n=l()(t.groups);!(e=(s=n.next()).done);e=!0){var o=s.value;this.rowdata.hostgroups.push(parseInt(o.groupid))}}catch(t){a=!0,r=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw r}}this.editForm=!0},updateGroup:function(){var t=this;this.rowdata.action="update",console.log(this.rowdata),Object(i.d)(this.rowdata).then(function(e){var a=11,r=!0,s=!1,n=void 0;try{for(var o,i=l()(e.data);!(r=(o=i.next()).done);r=!0){var c=o.value;a*=3,t.$notify({title:c.title,message:c.message,type:c.type,offset:a})}}catch(t){s=!0,n=t}finally{try{!r&&i.return&&i.return()}finally{if(s)throw n}}t.fetchData(),t.editForm=!1}).catch(function(e){var a=n()(e.response.data);t.$message.error(a)})},deleteGroup:function(t){var e=this;t.action="delete",Object(i.d)(t).then(function(t){var a=11,r=!0,s=!1,n=void 0;try{for(var o,i=l()(t.data);!(r=(o=i.next()).done);r=!0){var c=o.value;a*=3,e.$notify({title:c.title,message:c.message,type:c.type,offset:a})}}catch(t){s=!0,n=t}finally{try{!r&&i.return&&i.return()}finally{if(s)throw n}}e.fetchData()}).catch(function(t){var a=n()(t.response.data);e.$message.error(a)})}}},p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"components-container",staticStyle:{height:"100vh"}},[a("el-card",[a("div",{staticClass:"head-lavel"},[a("div",{staticClass:"table-button"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.addForm=!0}}},[t._v("新建")])],1),t._v(" "),a("div",{staticClass:"table-search"},[a("el-input",{attrs:{placeholder:"搜索 ..."},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.searchClick(e)}},model:{value:t.listQuery.search,callback:function(e){t.$set(t.listQuery,"search",e)},expression:"listQuery.search"}},[a("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:t.searchClick},slot:"suffix"})])],1)]),t._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataloading,expression:"dataloading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"让子弹飞一会儿","element-loading-background":"rgba(0, 0, 0, 0.8)",data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"hostid",label:"id"}}),t._v(" "),a("el-table-column",{attrs:{prop:"host",label:"主机名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"name-wrapper",staticStyle:{"text-align":"center"},attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{type:t.STATUS_COLOR[e.row.status]}},[t._v("\n                "+t._s(t.STATUS_TEXT[e.row.status])+"\n              ")])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"groups",label:"所在组"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"name-wrapper",staticStyle:{"text-align":"center"},attrs:{slot:"reference"},slot:"reference"},t._l(e.row.groups,function(e){return a("el-tag",{key:e.groupid,staticStyle:{"margin-right":"3px"},attrs:{size:"mini"}},[t._v("\n                "+t._s(e.name)+"\n              ")])}))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"interfaces",label:"监听地址"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"name-wrapper",staticStyle:{"text-align":"center"},attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{staticStyle:{"margin-right":"3px"},attrs:{size:"mini"}},[t._v("\n                "+t._s(e.row.interfaces[0].ip)+":"+t._s(e.row.interfaces[0].port)+"\n              ")])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button-group",[a("el-button",{attrs:{type:"success",size:"small",disabled:""},on:{click:function(a){t.changeGroup(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){t.deleteGroup(e.row)}}},[t._v("删除")])],1)]}}])})],1)],1),t._v(" "),a("div",{staticClass:"table-pagination"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":t.pagesize,"page-size":t.listQuery.limit,layout:t.pageformat,total:t.tabletotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e}}})],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.addForm},on:{"update:visible":function(e){t.addForm=e}}},[a("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"主机名ip",prop:"hostnames"}},[a("el-input",{attrs:{type:"textarea",placeholder:"sh-aa-01|sh-bb-02",autosize:{minRows:3,maxRows:5}},model:{value:t.hostnames,callback:function(e){t.hostnames=e},expression:"hostnames"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"主机组",prop:"hostgroups"}},[a("sesect-groups",{attrs:{selectdata:t.ruleForm.hostgroups},on:{getDatas:t.getGroups}})],1),t._v(" "),a("el-form-item",{attrs:{label:"模板",prop:"templates"}},[a("sesect-temps",{attrs:{selectdata:t.ruleForm.templates},on:{getDatas:t.getTemps}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.createGroup("ruleForm")}}},[t._v("立即创建")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.editForm},on:{"update:visible":function(e){t.editForm=e}}},[a("el-form",{ref:"rowdata",attrs:{model:t.rowdata,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"主机名",prop:"host"}},[a("el-input",{model:{value:t.rowdata.host,callback:function(e){t.$set(t.rowdata,"host",e)},expression:"rowdata.host"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"主机组",prop:"hostgroups"}},[a("sesect-groups",{attrs:{selectdata:t.rowdata.hostgroups},on:{getDatas:t.getGroups}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.updateGroup("rowdata")}}},[t._v("立即更新")])],1)],1)],1)],1)},h=[],m={render:p,staticRenderFns:h},g=m,v=a("VU/8"),b=r,y=v(f,g,!1,b,null,null);e.default=y.exports},XLtN:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"",""])},cYOQ:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".transfer-footer{margin-left:20px;padding:6px 5px}",""])},hBdI:function(t,e,a){var r=a("cYOQ");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("6b70e980",r,!0)},pWMD:function(t,e,a){var r=a("F1wk");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("26225dde",r,!0)},zgBx:function(t,e,a){var r=a("XLtN");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("3ff6e7e0",r,!0)}});