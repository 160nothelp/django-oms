webpackJsonp([0],{"6AAb":function(t,e,r){var a=r("w3x3");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r("rjj0")("24129d51",a,!0)},GGwe:function(t,e,r){"use strict";function a(t){r("6AAb")}Object.defineProperty(e,"__esModule",{value:!0});var o=r("BO1k"),n=r.n(o),i=r("Dd8w"),s=r.n(i),l=r("ZTLr"),u=r("nSkA"),c=r("vMJZ"),d=r("QmSG"),p=r("NYxO"),m=r("V9py"),f=r.n(m),h={components:{},data:function(){return{route_path:this.$route.path.split("/"),ruleForm:{title:"",type:"",content:"",create_user:localStorage.getItem("username"),level:2,action_user:"itsupport",follower:"",create_group:"",ticketid:""},rules:{title:[{required:!0,message:"请输入工单标题",trigger:"blur"}],content:[{required:!0,message:"请输入工单内容",trigger:"blur"}],type:[{required:!0,message:"请选择工单类型",trigger:"blur"}],level:[{required:!0,type:"number",message:"请确认工单等级",trigger:"blur"}]},users:[],fileList:[],count:0,enclosureFile:[],enclosureForm:{ticket:"",create_user:localStorage.getItem("username"),file:"",create_group:""},toolbars:{preview:!0,bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,ol:!0,fullscreen:!0,help:!0},img_file:{},formDataList:[],to_list:"",cc_list:"",uploadurl:d.uploadurl,types:[]}},computed:s()({},Object(p.b)(["username"])),created:function(){this.getTicketUsers(),this.getTicketType()},methods:{postForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.ruleForm.ticketid=f()(),Object(l.k)(e.ruleForm).then(function(t){'"Created"'===t.statusText&&e.$message({type:"success",message:"恭喜你，新建成功"});var r=!0,a=!1,o=void 0;try{for(var i,s=n()(e.fileList);!(r=(i=s.next()).done);r=!0){var c=i.value,d=new FormData;d.append("username",e.enclosureForm.create_user),d.append("file",c),d.append("create_time",f()(c.uid)),d.append("type",c.type),d.append("archive",e.route_path[1]),Object(u.d)(d).then(function(r){e.enclosureForm.file=r.data.filepath,e.enclosureForm.ticket=t.data.id,Object(l.i)(e.enclosureForm)})}}catch(t){a=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}var p={to:e.ruleForm.action_user,cc:e.ruleForm.follower.join(),sub:"【新工单】"+e.ruleForm.title,content:window.location.host+"/#/worktickets/editworkticket/"+e.ruleForm.ticketid};Object(u.c)(p),e.$router.push("/worktickets/workticket")})})},resetForm:function(t){this.$refs[t].resetFields()},getTicketUsers:function(){var t=this;Object(c.f)().then(function(e){t.users=e.data})},getTicketType:function(){var t=this;Object(l.e)().then(function(e){t.types=e.data})},handleSuccess:function(t,e){this.fileList.push(e.raw),this.count+=1},handleRemove:function(t,e){this.fileList.remove(t),this.count-=1},imgAdd:function(t,e){var r=this.$refs.md,a=new FormData;a.append("username",this.enclosureForm.create_user),a.append("file",e),a.append("create_time",f()(e.lastModified)),a.append("type",e.type),a.append("archive",this.route_path[1]),Object(u.d)(a).then(function(e){r.$imglst2Url([[t,e.data.file]])})}}},b=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"components-container",staticStyle:{height:"100vh"}},[r("el-card",[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入标题"},model:{value:t.ruleForm.title,callback:function(e){t.$set(t.ruleForm,"title",e)},expression:"ruleForm.title"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"指派人",prop:"action_user"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择指派人"},model:{value:t.ruleForm.action_user,callback:function(e){t.$set(t.ruleForm,"action_user",e)},expression:"ruleForm.action_user"}},t._l(t.users,function(t){return r("el-option",{key:t.id,attrs:{value:t.username}})})),t._v(" "),r("a",{staticClass:"tips"},[t._v(" Tip：当前工单处理人，默认是指派给ITSupport群组")])],1),t._v(" "),r("el-form-item",{attrs:{label:"跟踪者",prop:"follower"}},[r("el-select",{attrs:{filterable:"",multiple:"",placeholder:"请选择跟踪者"},model:{value:t.ruleForm.follower,callback:function(e){t.$set(t.ruleForm,"follower",e)},expression:"ruleForm.follower"}},t._l(t.users,function(t){return r("el-option",{key:t.id,attrs:{value:t.username}})})),t._v(" "),r("a",{staticClass:"tips"},[t._v(" Tip：工单状态发生变更时，邮件抄送给跟踪者")])],1),t._v(" "),r("el-form-item",{attrs:{label:"工单类型",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择工单类型"},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},t._l(t.types,function(t){return r("el-option",{key:t.id,attrs:{value:t.name}})}))],1),t._v(" "),r("el-form-item",{attrs:{label:"工单内容",prop:"content"}},[r("mavon-editor",{ref:"md",staticStyle:{"z-index":"1"},attrs:{code_style:"monokai",toolbars:t.toolbars},on:{imgAdd:t.imgAdd},model:{value:t.ruleForm.content,callback:function(e){t.$set(t.ruleForm,"content",e)},expression:"ruleForm.content"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"工单等级",prop:"level"}},[r("el-rate",{attrs:{colors:["#99A9BF","#F7BA2A","#ff1425"],"show-text":"",texts:["E","D","C","B","A"]},model:{value:t.ruleForm.level,callback:function(e){t.$set(t.ruleForm,"level",e)},expression:"ruleForm.level"}}),t._v(" "),r("div",[r("hr",{staticClass:"heng"}),t._v(" "),r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.uploadurl,"on-success":t.handleSuccess,"on-remove":t.handleRemove,"file-list":t.fileList}},[r("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.count>2},slot:"trigger"},[t._v("\n              上传文件\n            ")]),t._v("\n            (可以不用上传)\n            "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[r("p",[t._v("上传文件不超过10m，"),r("a",{staticStyle:{color:"red"}},[t._v("最多只能上传3个文件")])])])],1),t._v(" "),r("hr",{staticClass:"heng"})],1)],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.postForm("ruleForm")}}},[t._v("提交")]),t._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("清空")])],1)],1)],1)],1)},g=[],v={render:b,staticRenderFns:g},k=v,x=r("VU/8"),w=a,y=x(h,k,!1,w,null,null);e.default=y.exports},V9py:function(t,e){t.exports=function(t){var e=void 0;return e=t?new Date(t):new Date,e.getFullYear().toString()+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+e.getDate()+e.getHours()+e.getMinutes()+e.getSeconds()}},ZTLr:function(t,e,r){"use strict";function a(t){return Object(h.a)({url:g.a.worktickers,method:"post",data:t})}function o(t){return Object(h.a)({url:g.a.worktickers,method:"get",params:t})}function n(t,e){return Object(h.a)({url:g.a.worktickers+t+"/",method:"patch",data:e})}function i(t){return Object(h.a)({url:g.a.tickettypes,method:"post",data:t})}function s(t){return Object(h.a)({url:g.a.tickettypes,method:"get",params:t})}function l(t,e){return Object(h.a)({url:g.a.tickettypes+t+"/",method:"put",data:e})}function u(t){return Object(h.a)({url:g.a.tickettypes+t+"/",method:"delete"})}function c(t){return Object(h.a)({url:g.a.ticketcomments,method:"post",data:t})}function d(t){return Object(h.a)({url:g.a.ticketcomments,method:"get",params:t})}function p(t){return Object(h.a)({url:g.a.ticketenclosures,method:"post",data:t})}function m(t){return Object(h.a)({url:g.a.ticketenclosures,method:"get",params:t})}function f(t){return Object(h.a)({url:g.a.ticketenclosures+t+"/",method:"delete"})}e.k=a,e.f=o,e.g=n,e.j=i,e.e=s,e.l=l,e.b=u,e.h=c,e.c=d,e.i=p,e.d=m,e.a=f;var h=r("vLgD"),b=r("QmSG"),g=r.n(b)},kCe2:function(t,e,r){"use strict";function a(t){r("vZ2Z")}var o={name:"PanThumb",props:{image:{type:String,required:!0},zIndex:{type:Number,default:100},width:{type:String,default:"150px"},height:{type:String,default:"150px"}}},n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"pan-item",style:{zIndex:t.zIndex,height:t.height,width:t.width}},[r("div",{staticClass:"pan-info"},[r("div",{staticClass:"pan-info-roles-container"},[t._t("default")],2)]),t._v(" "),r("img",{staticClass:"pan-thumb",attrs:{src:t.image}})])},i=[],s={render:n,staticRenderFns:i},l=s,u=r("VU/8"),c=a,d=u(o,l,!1,c,"data-v-d3909884",null);e.a=d.exports},nSkA:function(t,e,r){"use strict";function a(t){return Object(s.a)({url:u.a.uploads,method:"post",data:t})}function o(t,e){return Object(s.a)({url:e?u.a.uploads+e+"/":u.a.uploads,method:"get",params:t})}function n(t){return Object(s.a)({url:u.a.uploads+t+"/",method:"delete"})}function i(t){return Object(s.a)({url:u.a.sendmail,method:"post",data:t})}e.d=a,e.b=o,e.a=n,e.c=i;var s=r("vLgD"),l=r("QmSG"),u=r.n(l)},tmVe:function(t,e,r){e=t.exports=r("FZ+f")(!1),e.push([t.i,'.pan-item[data-v-d3909884]{width:200px;height:200px;border-radius:50%;display:inline-block;position:relative;cursor:default;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.2);box-shadow:0 1px 3px rgba(0,0,0,.2)}.pan-info-roles-container[data-v-d3909884]{padding:20px;text-align:center}.pan-thumb[data-v-d3909884]{width:100%;height:100%;background-size:100%;border-radius:50%;overflow:hidden;position:absolute;-webkit-transform-origin:95% 40%;transform-origin:95% 40%;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}.pan-thumb[data-v-d3909884]:after{content:"";width:8px;height:8px;position:absolute;border-radius:50%;top:40%;left:95%;margin:-4px 0 0 -4px;background:radial-gradient(ellipse at center,#0e0e0e 0,#7d7e7d 100%);-webkit-box-shadow:0 0 1px hsla(0,0%,100%,.9);box-shadow:0 0 1px hsla(0,0%,100%,.9)}.pan-info[data-v-d3909884]{position:absolute;width:inherit;height:inherit;border-radius:50%;overflow:hidden;-webkit-box-shadow:inset 0 0 0 5px rgba(0,0,0,.05);box-shadow:inset 0 0 0 5px rgba(0,0,0,.05)}.pan-info h3[data-v-d3909884]{color:#fff;text-transform:uppercase;position:relative;letter-spacing:2px;font-size:18px;margin:0 60px;padding:22px 0 0;height:85px;font-family:Open Sans,Arial,sans-serif;text-shadow:0 0 1px #fff,0 1px 2px rgba(0,0,0,.3)}.pan-info p[data-v-d3909884]{color:#fff;padding:10px 5px;font-style:italic;margin:0 30px;font-size:12px;border-top:1px solid hsla(0,0%,100%,.5)}.pan-info p a[data-v-d3909884]{display:block;color:#333;width:80px;height:80px;background:hsla(0,0%,100%,.3);border-radius:50%;color:#fff;font-style:normal;font-weight:700;text-transform:uppercase;font-size:9px;letter-spacing:1px;padding-top:24px;margin:7px auto 0;font-family:Open Sans,Arial,sans-serif;opacity:0;-webkit-transition:opacity .3s ease-in-out .2s,background .2s linear 0s,-webkit-transform .3s ease-in-out .2s;transition:opacity .3s ease-in-out .2s,background .2s linear 0s,-webkit-transform .3s ease-in-out .2s;transition:transform .3s ease-in-out .2s,opacity .3s ease-in-out .2s,background .2s linear 0s;transition:transform .3s ease-in-out .2s,opacity .3s ease-in-out .2s,background .2s linear 0s,-webkit-transform .3s ease-in-out .2s;-webkit-transform:translateX(60px) rotate(90deg);transform:translateX(60px) rotate(90deg)}.pan-info p a[data-v-d3909884]:hover{background:hsla(0,0%,100%,.5)}.pan-item:hover .pan-thumb[data-v-d3909884]{-webkit-transform:rotate(-110deg);transform:rotate(-110deg)}.pan-item:hover .pan-info p a[data-v-d3909884]{opacity:1;-webkit-transform:translateX(0) rotate(0deg);transform:translateX(0) rotate(0deg)}',""])},vMJZ:function(t,e,r){"use strict";function a(t){return Object(m.a)({url:h.a.users,method:"post",data:t})}function o(t){return Object(m.a)({url:h.a.users,method:"get",params:t})}function n(t,e){return Object(m.a)({url:h.a.users+t+"/",method:"patch",data:e})}function i(t){return Object(m.a)({url:h.a.users+t,method:"delete"})}function s(t){return Object(m.a)({url:h.a.groups,method:"post",data:t})}function l(t){return Object(m.a)({url:h.a.groups,method:"get",params:t})}function u(t){return Object(m.a)({url:h.a.groups+t,method:"delete"})}function c(t){return Object(m.a)({url:h.a.roles,method:"post",data:t})}function d(t){return Object(m.a)({url:h.a.roles,method:"get",params:t})}function p(t){return Object(m.a)({url:h.a.roles+t,method:"delete"})}e.j=a,e.f=o,e.g=n,e.c=i,e.h=s,e.d=l,e.a=u,e.i=c,e.e=d,e.b=p;var m=r("vLgD"),f=r("QmSG"),h=r.n(f)},vZ2Z:function(t,e,r){var a=r("tmVe");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r("rjj0")("4728ef61",a,!0)},w3x3:function(t,e,r){e=t.exports=r("FZ+f")(!1),e.push([t.i,".heng{margin:20px 0;height:1px;border:0;background-color:rgba(174,127,255,.38);color:#29e11c}.addticket{margin:50px;width:80%}.tips{color:hsla(0,0%,50%,.65)}",""])}});