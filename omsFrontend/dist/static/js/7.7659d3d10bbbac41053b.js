webpackJsonp([7],{"1n3Z":function(t,e,a){"use strict";function i(t){a("3ILi")}var s={name:"BackToTop",props:{visibilityHeight:{type:Number,default:400},backPosition:{type:Number,default:0},customStyle:{type:Object,default:{right:"50px",bottom:"50px",width:"40px",height:"40px","border-radius":"4px","line-height":"45px",background:"#e7eaf1"}},transitionName:{type:String,default:"fade"}},data:function(){return{visible:!1,interval:null}},mounted:function(){window.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll),this.interval&&clearInterval(this.interval)},methods:{handleScroll:function(){this.visible=window.pageYOffset>this.visibilityHeight},backToTop:function(){var t=this,e=window.pageYOffset,a=0;this.interval=setInterval(function(){var i=Math.floor(t.easeInOutQuad(10*a,e,-e,500));i<=t.backPosition?(window.scrollTo(0,t.backPosition),clearInterval(t.interval)):window.scrollTo(0,i),a++},16.7)},easeInOutQuad:function(t,e,a,i){return(t/=i/2)<1?a/2*t*t+e:-a/2*(--t*(t-2)-1)+e}}},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:t.transitionName}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"back-to-ceiling",style:t.customStyle,on:{click:t.backToTop}},[a("svg",{staticClass:"Icon Icon--backToTopArrow",staticStyle:{height:"16px",width:"16px"},attrs:{width:"16",height:"16",viewBox:"0 0 17 17",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"}},[a("title",[t._v("回到顶部")]),t._v(" "),a("g",[a("path",{attrs:{d:"M12.036 15.59c0 .55-.453.995-.997.995H5.032c-.55 0-.997-.445-.997-.996V8.584H1.03c-1.1 0-1.36-.633-.578-1.416L7.33.29c.39-.39 1.026-.385 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.004z","fill-rule":"evenodd"}})])])])])},n=[],r={render:o,staticRenderFns:n},c=r,l=a("VU/8"),d=i,u=l(s,c,!1,d,"data-v-3531eed5",null);e.a=u.exports},"3ILi":function(t,e,a){var i=a("nMwr");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("321a9d91",i,!0)},"5S43":function(t,e,a){"use strict";function i(t){a("lRR+")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("Dd8w"),o=a.n(s),n=a("EMlb"),r=a("nSkA"),c=a("QmSG"),l=a("Xoog"),d=a.n(l),u=a("vMJZ"),p=a("1n3Z"),m=a("NYxO"),h=a("0xDb"),v=a("TDrc"),f=a("6HvL"),_={components:{VueMarkdown:d.a,BackToTop:p.a,addBug:v.default,addTest:f.default},data:function(){return{route_path:this.$route.path.split("/"),pid:this.$route.params.id,ticket_id:"",ticketData:{},commentData:{},enclosureData:{},apiurl:c.apiUrl,commentForm:{project:"",create_user:localStorage.getItem("username"),content:""},enclosureForm:{ticket:"",create_user:localStorage.getItem("username"),file:""},rowdata:{status:1,action_user:""},count:0,toolbars:{preview:!0,bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,ol:!0,fullscreen:!0,help:!0},users:[],BackToTopStyle:{right:"50px",bottom:"50px",width:"40px",height:"40px","border-radius":"4px","line-height":"45px",background:"#a2fdff"},workticketlist_btn_edit:!1,uploadurl:c.uploadurl,STATUS_TEXT:{0:"未指派",1:"已指派",2:"处理中",3:"待审核",4:"已完成"},STATUS_TYPE:{0:"danger",1:"primary",2:"success",3:"warning",4:"info"},showinput:!1,radio_status:"0",addBugFrom:!1,addTestFrom:!1,bugData:[],testData:[],bugquery:{project__id:"",test_id:"",id:""},testquery:{project__id:"",id:""},commentquery:{project__id:""},showBugForm:!1,showTestForm:!1}},computed:o()({},Object(m.b)(["role","elements"])),created:function(){this.bugquery.project__id=this.testquery.project__id=this.commentquery.project__id=this.commentForm.project=this.pid,this.workticketlist_btn_edit=this.elements["编辑工单-编辑工单按钮"],this.fetchData(),this.fetchBugData(),this.fetchTestData(),this.CommentData(),this.getTicketUsers()},methods:{fetchData:function(){var t=this;Object(n.e)(null,this.pid).then(function(e){t.ticketData=e.data})},getDialogStatus:function(t){this.addBugFrom=t,this.addTestFrom=t,this.fetchBugData(),this.fetchTestData()},CommentData:function(){var t=this;Object(n.f)(this.commentquery).then(function(e){t.commentData=e.data}),this.commentForm.content=""},fetchBugData:function(){var t=this;Object(n.d)(this.bugquery).then(function(e){t.bugData=e.data})},fetchTestData:function(){var t=this;Object(n.h)(this.testquery).then(function(e){t.testData=e.data})},submitForm:function(t){var e=this;console.log(this.commentForm),Object(n.l)(this.commentForm).then(function(t){e.CommentData()}).catch(function(){e.$message({type:"error",message:"提交有误"})})},patchForm:function(t){Object(n.i)(this.pid,t)},imgAdd:function(t,e){var a=this.$refs.md,i=new FormData;i.append("username",this.username),i.append("file",e),i.append("create_time",Object(h.a)(e.lastModified)),i.append("type",e.type),i.append("archive",this.route_path[1]),Object(r.i)(i).then(function(e){a.$imglst2Url([[t,e.data.file]])})},getTicketUsers:function(){var t=this;Object(u.f)().then(function(e){t.users=e.data})},showBug:function(t){this.showBugForm=!0},showTest:function(t){this.showTestForm=!0},clicktestTable:function(t){this.bugquery.test_id=t.id,this.fetchBugData()}}},g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"components-container",staticStyle:{height:"100vh"}},[a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:18}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("a",{staticClass:"title"},[t._v(t._s(t.ticketData.name))]),t._v(" "),a("hr",{staticClass:"heng"}),t._v(" "),a("div",{staticClass:"appendInfo"},[a("a",{staticClass:"ticketinfo create_user"},[a("span",{staticClass:"han"},[t._v("\n                              创建时间：")]),t._v(t._s(t._f("parseDate")(t.ticketData.create_time)))]),t._v(" "),a("a",{staticClass:"ticketinfo create_user"},[a("span",{staticClass:"han"},[a("a",{staticClass:"shu"}),t._v("\n                              发起人：")]),t._v(t._s(t.ticketData.create_user))]),t._v(" "),a("a",{staticClass:"ticketinfo action_user"},[a("span",{staticClass:"han"},[a("a",{staticClass:"shu"}),t._v("指派人：")]),t._v(" "),t._l(t.ticketData.action_user,function(e){return a("el-tag",{key:e.id,staticStyle:{"margin-right":"3px"},attrs:{size:"mini"}},[t._v(t._s(e)+"\n                ")])})],2),t._v(" "),a("a",{staticClass:"shu"}),t._v(" "),a("span",{staticClass:"han"},[t._v("类型：")]),t._v(" "),a("a",[t._v(t._s(t.ticketData.type))]),t._v(" "),a("a",{staticClass:"shu"}),t._v(" "),a("span",{staticClass:"han"},[t._v("当前状态：")]),t._v(" "),a("el-tag",{attrs:{type:t.STATUS_TYPE[t.ticketData.status]}},[t._v("\n                "+t._s(t.STATUS_TEXT[t.ticketData.status])+"\n              ")])],1),t._v(" "),!t.workticketlist_btn_edit&&"super"!==t.role||2==t.ticketData.ticket_status?t._e():a("div",{staticClass:"appendInfo"},[a("span",{staticClass:"han"},[t._v("操作：")]),t._v(" "),t.showinput?t._e():a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){t.showinput=!0}}},[t._v("编辑")]),t._v(" "),t.showinput?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(e){t.showinput=!1}}},[t._v("收起")]):t._e(),t._v(" "),t.showinput?a("div",{staticClass:"action"},[a("el-radio-group",{model:{value:t.radio_status,callback:function(e){t.radio_status=e},expression:"radio_status"}},[a("el-radio",{attrs:{label:"0"}},[t._v("不操作")]),t._v(" "),a("el-radio",{attrs:{label:"2"}},[t._v("关闭任务")])],1),t._v(" "),a("a",{staticClass:"tips",staticStyle:{display:"block",margin:"5px 160px -20px"}},[t._v(" Tip：请在下方回复内容并提交")])],1):t._e()],1)]),t._v(" "),a("vue-markdown",{attrs:{source:t.ticketData.content}})],1),t._v(" "),2!=t.ticketData.ticket_status&&t.showinput?a("div",[a("el-form",{ref:"content",staticClass:"demo-ruleForm",attrs:{model:t.commentForm,"label-width":"80px"}},[a("hr",{staticClass:"heng"}),t._v(" "),a("el-form-item",{attrs:{label:"问题处理",prop:"content"}},[a("mavon-editor",{ref:"md",staticStyle:{"z-index":"1"},attrs:{code_style:"monokai",toolbars:t.toolbars},on:{imgAdd:t.imgAdd},model:{value:t.commentForm.content,callback:function(e){t.$set(t.commentForm,"content",e)},expression:"commentForm.content"}}),t._v(" "),a("a",{staticClass:"tips"},[t._v(" Tip：截图可以直接 Ctrl + v 粘贴到问题处理里面")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")])],1)],1)],1):t._e(),t._v(" "),t.commentData.length>0?a("el-card",{staticClass:"ticketcomment"},[t._v("\n          处理历史记录\n          "),t._l(t.commentData,function(e){return a("div",{key:e.id},[a("hr",{staticClass:"heng"}),t._v(" "),a("el-row",[a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"commentuser",attrs:{type:"primary",plain:""}},[t._v(t._s(e.create_user))])],1),t._v(" "),a("el-col",{attrs:{span:14}},[a("div",{staticClass:"dialog-box"},[a("span",{staticClass:"bot"}),t._v(" "),a("span",{staticClass:"top"}),t._v(" "),a("div",{staticClass:"comment"},[a("vue-markdown",{attrs:{source:e.content}}),t._v(" "),a("p",{staticClass:"commenttime"},[t._v("处理时间："+t._s(t._f("parseDate")(e.create_time)))])],1)])])],1)],1)})],2):t._e()],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("a",{staticClass:"right-title"},[t._v("测试用例")]),t._v(" "),a("el-button",{staticClass:"card-head-btn",attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){t.addTestFrom=!0}}})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.testData,stripe:""},on:{"row-click":t.clicktestTable}},[a("el-table-column",{attrs:{prop:"id",label:"Id",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"fa fa-hashtag"}),t._v(t._s(e.row.id)+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{slot:"reference"},slot:"reference"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.showTest(e.row)}}},[t._v(t._s(e.row.name))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"action_user",label:"开发",width:"100"}})],1)],1),t._v(" "),a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("a",{staticClass:"right-title"},[t._v("关联bug")]),t._v(" "),a("el-button",{staticClass:"card-head-btn",attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){t.addBugFrom=!0}}})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.bugData,stripe:""}},[a("el-table-column",{attrs:{prop:"id",label:"Id",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"fa fa-hashtag"}),t._v(t._s(e.row.id)+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{slot:"reference"},slot:"reference"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.showBug(e.row)}}},[t._v(t._s(e.row.name))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"action_user",label:"开发",width:"100"}})],1)],1)],1)],1)],1),t._v(" "),a("el-tooltip",{attrs:{placement:"top",content:"一路向西"}},[a("back-to-top",{attrs:{transitionName:"fade",customStyle:t.BackToTopStyle,visibilityHeight:300,backPosition:50}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.addBugFrom},on:{"update:visible":function(e){t.addBugFrom=e}}},[a("add-bug",{attrs:{pname:t.ticketData.name},on:{DialogStatus:t.getDialogStatus}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.addTestFrom},on:{"update:visible":function(e){t.addTestFrom=e}}},[a("add-test",{attrs:{pname:t.ticketData.name},on:{DialogStatus:t.getDialogStatus}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.showBugForm},on:{"update:visible":function(e){t.showBugForm=e}}},[a("div",[t._v("bug详情")])]),t._v(" "),a("el-dialog",{attrs:{visible:t.showTestForm},on:{"update:visible":function(e){t.showTestForm=e}}},[a("div",[t._v("test详情")])])],1)},b=[],k={render:g,staticRenderFns:b},w=k,x=a("VU/8"),y=i,T=x(_,w,!1,y,null,null);e.default=T.exports},gevR:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".editticket{margin:50px;width:80%}.title{font-size:28px;font-weight:700;padding-left:10px}.right-title{font-size:20px;font-weight:600;padding-left:10px}.card-head-btn{float:right;padding:3px 0}.appendInfo{padding:5px;margin:5px}.action{display:inline;margin-left:20px}.han{margin-left:5px}.content{margin:20px 5px}.ticketcomment{margin-top:20px;background-color:rgba(48,250,81,.17)}.ticketcomment .dialog-box{position:relative;left:100px;margin-left:-20px}.ticketcomment .dialog-box span{width:0;height:0;font-size:0;overflow:hidden;position:absolute}.ticketcomment .dialog-box span.bot{border-width:16px;border-style:solid dashed dashed;border-color:transparent rgba(48,250,81,.38) transparent transparent;top:10px;left:-30px}.ticketcomment .dialog-box .comment{border:1px solid rgba(255,164,186,.62);padding:6px;margin-bottom:10px;min-height:50px;max-width:600px;width:50rem}.ticketcomment .dialog-box .comment .commenttime{float:right}",""])},"lRR+":function(t,e,a){var i=a("gevR");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("5d7d109c",i,!0)},nMwr:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".back-to-ceiling[data-v-3531eed5]{position:fixed;display:inline-block;text-align:center;cursor:pointer}.back-to-ceiling[data-v-3531eed5]:hover{background:#d5dbe7}.back-to-ceiling .Icon[data-v-3531eed5]{fill:#9aaabf;background:none}",""])}});